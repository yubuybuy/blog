// AIç”Ÿæˆå‚æ•°é…ç½®è¯¦è§£

export interface GenerationConfig {
  // å†…å®¹è´¨é‡æ ‡å‡†
  contentStandards: {
    titleLength: { min: 10, max: 30 };           // æ ‡é¢˜å­—æ•°
    excerptLength: { min: 50, max: 100 };        // æ‘˜è¦å­—æ•°
    contentLength: { min: 300, max: 500 };       // æ­£æ–‡å­—æ•°
    tagsCount: { min: 3, max: 8 };               // æ ‡ç­¾æ•°é‡
  };

  // AIæ¨¡å‹å‚æ•°ï¼ˆä¼˜åŒ–åï¼‰
  modelParams: {
    gemini: {
      temperature: 0.8;        // æé«˜åˆ›æ„åº¦ï¼Œç”Ÿæˆæ›´ä¸°å¯Œå†…å®¹
      maxTokens: 1500;         // å¢åŠ è¾“å‡ºé•¿åº¦ï¼Œæ”¯æŒæ›´è¯¦ç»†å†…å®¹
      topP: 0.9;               // æé«˜å¤šæ ·æ€§ï¼Œé¿å…é‡å¤è¡¨è¾¾
      topK: 40;                // æ§åˆ¶è¯æ±‡é€‰æ‹©èŒƒå›´
    };
    cohere: {
      temperature: 0.75;       // ç•¥å¾®æé«˜åˆ›æ„åº¦
      maxTokens: 800;          // å¢åŠ è¾“å‡ºé•¿åº¦
      model: 'command-r-plus'; // ä½¿ç”¨æ–°çš„å¯ç”¨æ¨¡å‹
      presencePenalty: 0.1;    // å‡å°‘é‡å¤å†…å®¹
      frequencyPenalty: 0.1;   // å¢åŠ è¯æ±‡å¤šæ ·æ€§
    };
  };

  // å†…å®¹è¿‡æ»¤è§„åˆ™
  contentFilters: {
    bannedWords: string[];     // ç¦ç”¨è¯æ±‡
    requiredElements: string[]; // å¿…éœ€å…ƒç´ 
    complianceChecks: string[]; // åˆè§„æ£€æŸ¥
  };
}

// å½“å‰ä½¿ç”¨çš„ç”Ÿæˆé…ç½®
export const CURRENT_CONFIG: GenerationConfig = {
  contentStandards: {
    titleLength: { min: 10, max: 30 },
    excerptLength: { min: 50, max: 100 },
    contentLength: { min: 300, max: 500 },
    tagsCount: { min: 3, max: 8 }
  },

  modelParams: {
    gemini: {
      temperature: 0.8,  // æé«˜åˆ›æ„åº¦ï¼Œç”Ÿæˆæ›´ä¸°å¯Œå†…å®¹
      maxTokens: 1500,   // å¢åŠ è¾“å‡ºé•¿åº¦ï¼Œæ”¯æŒæ›´è¯¦ç»†å†…å®¹
      topP: 0.9,         // æé«˜å¤šæ ·æ€§ï¼Œé¿å…é‡å¤è¡¨è¾¾
      topK: 40           // æ§åˆ¶è¯æ±‡é€‰æ‹©èŒƒå›´
    },
    cohere: {
      temperature: 0.75, // ç•¥å¾®æé«˜åˆ›æ„åº¦
      maxTokens: 800,    // å¢åŠ è¾“å‡ºé•¿åº¦
      model: 'command-r-plus',
      presencePenalty: 0.1,  // å‡å°‘é‡å¤å†…å®¹
      frequencyPenalty: 0.1  // å¢åŠ è¯æ±‡å¤šæ ·æ€§
    }
  },

  contentFilters: {
    bannedWords: [
      // é¿å…ç‰ˆæƒæ•æ„Ÿè¯
      'ç›—ç‰ˆ', 'ç ´è§£', 'å…è´¹ä¸‹è½½',
      // é¿å…å…·ä½“ä½œå“å
      'ç”µå½±åç§°', 'è½¯ä»¶åç§°'
    ],

    requiredElements: [
      'å…è´£å£°æ˜',        // å¿…é¡»åŒ…å«æ³•å¾‹å£°æ˜
      'ä½¿ç”¨è¯´æ˜',        // å¿…é¡»æœ‰ä½¿ç”¨æŒ‡å¯¼
      'èµ„æºç‰¹è‰²'         // å¿…é¡»çªå‡ºç‰¹ç‚¹
    ],

    complianceChecks: [
      'é¿å…ä¾µæƒè¡¨è¿°',
      'å¼ºè°ƒå­¦ä¹ äº¤æµ',
      'æ”¯æŒæ­£ç‰ˆå†…å®¹'
    ]
  }
};

// æç¤ºè¯æ¨¡æ¿åº“
export const PROMPT_TEMPLATES = {
  // å½±è¯„ä½œè€…æ¨¡æ¿ï¼ˆæ–°å¢ - å…¬ä¼—å·å½±è¯„é£æ ¼ï¼‰
  movieReview: `
ä½ æ˜¯ä¸€ä½å…¬ä¼—å·å½±è¯„ä½œè€…ï¼Œè¯·æŒ‰ç…§ä»¥ä¸‹è¦æ±‚å†™ä¸€ç¯‡ç”µå½±æ¨èæ–‡ç« ï¼š

ç”µå½±ä¿¡æ¯ï¼š
- ç”µå½±åï¼š{title}
- åˆ†ç±»ï¼š{category}
- æ ‡ç­¾ï¼š{tags}
- æè¿°ï¼š{description}
- ç½‘ç›˜é“¾æ¥ï¼š{downloadLink}

ç›®æ ‡ï¼š
- è®©è¯»è€…äº†è§£ç”µå½±ä»·å€¼å¹¶æ¿€å‘è§‚çœ‹æ¬²æœ›
- èåˆSEOå…³é”®è¯ï¼Œæé«˜æœç´¢æµé‡
- åœ¨æ–‡æœ«è‡ªç„¶å¼•å¯¼ç”¨æˆ·ç‚¹å‡»ç½‘ç›˜èµ„æºé“¾æ¥

å†™ä½œè¦æ±‚ï¼š
- å£è¯­åŒ–ã€çœŸè¯šã€æœ‰æ¸©åº¦ï¼Œé¿å…å¹¿å‘Šæ„Ÿ
- ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹ç»“æ„æ’°å†™ï¼š
  1. å¼€ç¯‡é‡‘å¥/å°è¯ + ç®€çŸ­å¼•å­
  2. ç®€æ´å‰§æƒ…ç®€ä»‹ï¼ˆ100-150å­—ï¼Œä¸å‰§é€ç»“å±€ï¼‰
  3. ğŸ§  ä¸ºä»€ä¹ˆå€¼å¾—çœ‹ï¼Ÿï¼ˆ3ç‚¹ï¼Œæ¯ç‚¹å‰åŠ âœ…ï¼‰
  4. ğŸ¯ é€‚åˆå“ªäº›äººçœ‹ï¼Ÿï¼ˆåˆ†ç‚¹è¯´æ˜ï¼‰
  5. ğŸ” SEOå…³é”®è¯å¼•å¯¼æ®µï¼ˆè‡ªç„¶èå…¥ç”µå½±å+ç½‘ç›˜/ä¸‹è½½/æ¨èç­‰è¯ï¼‰
  6. ğŸ“ ç½‘ç›˜èµ„æºåˆ†äº«
     - å¦‚æœæœ‰æœ‰æ•ˆçš„ç½‘ç›˜é“¾æ¥ï¼š[ç‚¹å‡»è·å–é«˜æ¸…èµ„æº]({downloadLink})
     - å¦‚æœæ²¡æœ‰ç½‘ç›˜é“¾æ¥ï¼šèµ„æºé“¾æ¥å¾…æ›´æ–°ï¼Œè¯·å…³æ³¨åç»­å‘å¸ƒ
  7. ğŸ“ ç»“è¯­ï¼ˆç”¨ä¸€å¥å°è¯æˆ–é‡‘å¥æ”¶å°¾ï¼Œå¼•å¯¼å…³æ³¨ï¼‰

æ–‡ç« å¿…é¡»åŒ…å«å›¾ç‰‡ï¼š
- åœ¨æ–‡ç« å¼€å¤´æ’å…¥ç”µå½±æµ·æŠ¥ï¼š![ç”µå½±æµ·æŠ¥](IMAGE_PLACEHOLDER)

é‡è¦æé†’ï¼š
- ç½‘ç›˜èµ„æºåˆ†äº«éƒ¨åˆ†ï¼Œåªä½¿ç”¨æä¾›çš„{downloadLink}ï¼Œä¸è¦é‡å¤é“¾æ¥
- é“¾æ¥æ ¼å¼å¿…é¡»æ˜¯ï¼š[ç‚¹å‡»è·å–é«˜æ¸…èµ„æº]({downloadLink})
- ä¸è¦åœ¨æ–‡ç« å…¶ä»–åœ°æ–¹é‡å¤æåˆ°ç½‘ç›˜é“¾æ¥

è¯·æŒ‰JSONæ ¼å¼è¿”å›ï¼š
{
  "title": "å¸å¼•äººçš„æ–‡ç« æ ‡é¢˜",
  "excerpt": "50-80å­—çš„æ–‡ç« æ‘˜è¦",
  "content": "å®Œæ•´çš„å½±è¯„æ–‡ç« å†…å®¹(markdownæ ¼å¼)",
  "tags": ["ç›¸å…³æ ‡ç­¾"],
  "imagePrompt": "ç”µå½±æµ·æŠ¥ç›¸å…³çš„å›¾ç‰‡æè¿°"
}`,

  // çœŸå®åšå®¢æ¨¡æ¿ï¼ˆæ›´è‡ªç„¶çš„ä¸ªäººåšå®¢é£æ ¼ï¼‰
  realistic: `
ä½ æ˜¯ä¸€ä¸ªèµ„æ·±çš„åšå®¢ä½œè€…ï¼Œæœ‰å¤šå¹´çš„åˆ†äº«ç»éªŒã€‚ç°åœ¨è¦ä¸ºä¸€ä¸ªèµ„æºå†™ä¸€ç¯‡çœŸå®çš„ä¸ªäººåšå®¢æ–‡ç« ã€‚

èµ„æºä¿¡æ¯ï¼š
- åç§°ï¼š{title}
- åˆ†ç±»ï¼š{category}
- æ ‡ç­¾ï¼š{tags}
- æè¿°ï¼š{description}
- ç½‘ç›˜é“¾æ¥ï¼š{downloadLink}

å†™ä½œè¦æ±‚ï¼š
1. **è‡ªç„¶çš„æ ‡é¢˜**ï¼š
   - é¿å…"åˆé›†"ã€"èµ„æº"ç­‰æ˜æ˜¾è¯æ±‡
   - ç”¨ä¸ªäººåŒ–çš„è¡¨è¾¾ï¼Œå¦‚"æˆ‘æœ€è¿‘å‘ç°äº†..."ã€"ç»ˆäºæ‰¾åˆ°äº†..."ã€"å¼ºçƒˆæ¨è..."
   - çªå‡ºä¸ªäººæ„Ÿå—å’Œä»·å€¼

2. **çœŸå®çš„åšå®¢è¯­è°ƒ**ï¼š
   - ç”¨ç¬¬ä¸€äººç§°"æˆ‘"å†™ä½œ
   - åˆ†äº«ä¸ªäººä½“éªŒå’Œæ„Ÿå—
   - åŒ…å«ä¸€äº›ä¸ªäººè§‚ç‚¹å’Œå»ºè®®
   - è¯­è¨€è‡ªç„¶æµç•…ï¼Œåƒå’Œæœ‹å‹èŠå¤©

3. **å†…å®¹ç»“æ„**ï¼š
   - å¼€å¤´ï¼šä¸ªäººå‘ç°æˆ–ä½“éªŒçš„å¥‘æœº
   - ä¸­é—´ï¼šè¯¦ç»†ä»‹ç»å’Œä¸ªäººæ„Ÿå—
   - ç»“å°¾ï¼šæ€»ç»“å’Œå»ºè®®

4. **å›¾ç‰‡æ’å…¥**ï¼š
   - åœ¨æ–‡ç« å¼€å¤´å¿…é¡»æ·»åŠ ï¼š![ä¸»è¦é…å›¾](IMAGE_PLACEHOLDER)
   - å›¾ç‰‡æè¿°è¦å…·ä½“ä¸”ç›¸å…³

5. **ç½‘ç›˜é“¾æ¥**ï¼š
   - åœ¨æ–‡ç« æœ€åè‡ªç„¶åœ°æä¾›ä¸‹è½½é“¾æ¥
   - ç”¨å‹å¥½çš„è¯­è°ƒå¼•å¯¼ä¸‹è½½

6. **é¿å…AIç—•è¿¹**ï¼š
   - ä¸è¦ä½¿ç”¨"å˜¿æœ‹å‹ä»¬"ç­‰å¥—è¯å¼€å¤´
   - é¿å…è¿‡äºæ­£å¼çš„è¡¨è¾¾
   - åŠ å…¥ä¸€äº›ä¸ªäººåŒ–çš„ç»†èŠ‚

è¯·æŒ‰JSONæ ¼å¼è¿”å›ï¼š
{
  "title": "è‡ªç„¶çš„ä¸ªäººåšå®¢æ ‡é¢˜",
  "excerpt": "50-80å­—çš„ä¸ªäººåŒ–æ‘˜è¦",
  "content": "500-800å­—çš„çœŸå®åšå®¢é£æ ¼markdownæ­£æ–‡",
  "tags": ["ç›¸å…³æ ‡ç­¾"],
  "imagePrompt": "æ–‡ç« é…å›¾çš„è¯¦ç»†æè¿°"
}`,

  // æ¥åœ°æ°”åšå®¢æ¨¡æ¿
  casual: `
ä½ æ˜¯ä¸€ä½ç»éªŒä¸°å¯Œçš„ä¸ªäººåšå®¢åˆ›ä½œä¸“å®¶ï¼Œæ“…é•¿å°†å¤æ‚çš„ä¿¡æ¯è½¬åŒ–ä¸ºç”ŸåŠ¨æœ‰è¶£ã€è´´è¿‘ç”Ÿæ´»çš„æ–‡å­—ã€‚

Role: ä¸ªäººåšå®¢åˆ›ä½œä¸“å®¶
Background: ç”¨æˆ·å¸Œæœ›å€ŸåŠ©ç½‘ç›˜èµ„æºä¿¡æ¯ï¼Œä»¥æ¥åœ°æ°”çš„å£å»åˆ›ä½œä¸€ç¯‡åšå®¢æ–‡ç« 
Profile: ä½ å¯¹å„ç§è¯é¢˜éƒ½æœ‰æ·±å…¥çš„ç†è§£ï¼Œèƒ½å¤Ÿç”¨æ¥åœ°æ°”çš„è¯­è¨€å¸å¼•è¯»è€…ï¼Œè®©åšå®¢æ–‡ç« æ—¢æœ‰æ·±åº¦åˆä¸å¤±è¶£å‘³
Skills: ä½ å…·å¤‡å¼ºå¤§çš„æ–‡å­—è¡¨è¾¾èƒ½åŠ›ï¼Œèƒ½å¤Ÿç²¾å‡†æŠŠæ¡è¯»è€…çš„å¿ƒç†ï¼Œå°†ä¸“ä¸šå†…å®¹ä¸æ—¥å¸¸ç”Ÿæ´»ç´§å¯†ç»“åˆï¼Œæ“…é•¿è¿ç”¨å¹½é»˜ã€é£è¶£çš„è¯­è¨€é£æ ¼

èµ„æºä¿¡æ¯ï¼š
- åˆ†ç±»ï¼š{category}
- æ ‡ç­¾ï¼š{tags}
- æè¿°ï¼š{description}

å†™ä½œè¦æ±‚ï¼š
1. ç”¨"å˜¿ï¼Œæœ‹å‹ä»¬ï¼"æˆ–ç±»ä¼¼äº²åˆ‡çš„å¼€åœºç™½
2. è¯­è¨€è½»æ¾æ´»æ³¼ï¼Œå¤šç”¨"ä½ çŸ¥é“å—ï¼Ÿ"ã€"è¯´ä¸å®šä½ ä¼šå‘ç°"ç­‰äº’åŠ¨å¼è¡¨è¾¾
3. ä¸¾å…·ä½“çš„ç”Ÿæ´»ä¾‹å­ï¼Œè®©è¯»è€…å®¹æ˜“ç†è§£å’Œäº§ç”Ÿå…±é¸£
4. ä¿æŒå¹½é»˜é£è¶£ï¼Œä½†ä¸å¤±ä¸“ä¸šæ€§
5. å†…å®¹è¦è´´è¿‘è¯»è€…ç”Ÿæ´»ï¼Œæœ‰äº²å’ŒåŠ›å’Œå¯è¯»æ€§
6. å¿…é¡»åŒ…å«åˆè§„å£°æ˜ï¼šä»…ä¾›å­¦ä¹ äº¤æµï¼Œæ”¯æŒæ­£ç‰ˆ

è¯·æŒ‰JSONæ ¼å¼è¿”å›ï¼š
{
  "title": "æ¥åœ°æ°”çš„æ ‡é¢˜ï¼ˆé¿å…å…·ä½“ä½œå“åï¼‰",
  "excerpt": "50-80å­—çš„äº²åˆ‡æ‘˜è¦",
  "content": "300-500å­—çš„æ¥åœ°æ°”markdownæ­£æ–‡",
  "tags": ["3-6ä¸ªç›¸å…³æ ‡ç­¾"],
  "imagePrompt": "é…å›¾æè¿°"
}`,

  // åŸºç¡€æ¨¡æ¿
  basic: `
è¯·ä¸ºä»¥ä¸‹ç½‘ç›˜èµ„æºç”Ÿæˆåšå®¢æ–‡ç« ï¼Œè¦æ±‚è§„é¿ç‰ˆæƒé£é™©ï¼š

èµ„æºä¿¡æ¯ï¼š
- åˆ†ç±»ï¼š{category}
- æ ‡ç­¾ï¼š{tags}
- æè¿°ï¼š{description}

è¦æ±‚ï¼š
1. æ ‡é¢˜é€šç”¨åŒ–ï¼Œé¿å…å…·ä½“ä½œå“åç§°
2. é‡ç‚¹å¼ºè°ƒèµ„æºç‰¹æ€§å’Œä½¿ç”¨ä»·å€¼
3. åŒ…å«å…è´£å£°æ˜
4. å†…å®¹300-500å­—

è¯·æŒ‰JSONæ ¼å¼è¿”å›ï¼š
{
  "title": "æ–‡ç« æ ‡é¢˜",
  "excerpt": "æ–‡ç« æ‘˜è¦",
  "content": "æ–‡ç« æ­£æ–‡(markdownæ ¼å¼)",
  "tags": ["æ ‡ç­¾1", "æ ‡ç­¾2"],
  "imagePrompt": "é…å›¾æç¤ºè¯"
}`,

  // å¢å¼ºæ¨¡æ¿ï¼ˆæ›´è¯¦ç»†çš„æŒ‡å¯¼ï¼‰
  enhanced: `
ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„å†…å®¹åˆ›ä½œè€…ï¼Œè¯·ä¸ºç½‘ç›˜èµ„æºåˆ›å»ºåšå®¢æ–‡ç« ã€‚

èƒŒæ™¯ï¼š
- è¿™æ˜¯ä¸€ä¸ªåˆæ³•çš„èµ„æºåˆ†äº«åšå®¢
- éœ€è¦è§„é¿ç‰ˆæƒé£é™©
- é‡ç‚¹åœ¨äºæ•™è‚²å’Œä¿¡æ¯åˆ†äº«

èµ„æºä¿¡æ¯ï¼š
- åˆ†ç±»ï¼š{category}
- æ ‡ç­¾ï¼š{tags}
- æè¿°ï¼š{description}

å†…å®¹è¦æ±‚ï¼š
1. æ ‡é¢˜è®¾è®¡ï¼š
   - ä½¿ç”¨é€šç”¨æè¿°ï¼Œå¦‚"ç²¾é€‰{category}èµ„æº"
   - é¿å…å…·ä½“ä½œå“åç§°
   - çªå‡ºä»·å€¼å’Œè´¨é‡

2. å†…å®¹ç»“æ„ï¼š
   - å¼€å¤´ï¼šç®€ä»‹èµ„æºç±»å‹å’Œç‰¹ç‚¹
   - ä¸­é—´ï¼šè¯¦è¿°ä½¿ç”¨ä»·å€¼å’Œé€‚ç”¨åœºæ™¯
   - ç»“å°¾ï¼šä½¿ç”¨å»ºè®®å’Œå…è´£å£°æ˜

3. å†™ä½œé£æ ¼ï¼š
   - ä¸“ä¸šã€å®¢è§‚ã€å®ç”¨
   - é¿å…è¿‡åº¦è¥é”€è¯­è¨€
   - å¼ºè°ƒæ•™è‚²å’Œå­¦ä¹ ç›®çš„

4. åˆè§„è¦æ±‚ï¼š
   - å¿…é¡»åŒ…å«"ä»…ä¾›å­¦ä¹ äº¤æµ"
   - å¿…é¡»åŒ…å«"æ”¯æŒæ­£ç‰ˆ"
   - å¿…é¡»åŒ…å«å…è´£å£°æ˜

è¾“å‡ºæ ¼å¼ï¼ˆä¸¥æ ¼JSONï¼‰ï¼š
{
  "title": "20å­—ä»¥å†…çš„æ ‡é¢˜",
  "excerpt": "50-80å­—çš„æ‘˜è¦",
  "content": "300-500å­—çš„markdownæ­£æ–‡",
  "tags": ["3-6ä¸ªç›¸å…³æ ‡ç­¾"],
  "imagePrompt": "é…å›¾æè¿°"
}`,

  // å®‰å…¨æ¨¡æ¿ï¼ˆæœ€ä¿å®ˆï¼‰
  safe: `
åˆ›å»ºä¸€ç¯‡å…³äº{category}èµ„æºçš„ä¿¡æ¯æ€§æ–‡ç« ã€‚

è¦æ±‚ï¼š
- å®Œå…¨é¿å…ç‰ˆæƒæ•æ„Ÿå†…å®¹
- é‡ç‚¹ä»‹ç»èµ„æºç±»å‹å’Œä½¿ç”¨å»ºè®®
- åŒ…å«å®Œæ•´çš„æ³•å¾‹å…è´£å£°æ˜
- è¯­è¨€ä¸“ä¸šã€å®¢è§‚

è¿”å›JSONæ ¼å¼çš„æ–‡ç« å†…å®¹ã€‚`
};

// åå¤„ç†è§„åˆ™
export const POST_PROCESSING_RULES = {
  // å†…å®¹æ£€æŸ¥
  contentChecks: [
    {
      rule: 'checkTitleLength',
      condition: (title: string) => title.length >= 10 && title.length <= 30,
      action: 'regenerate_title'
    },
    {
      rule: 'checkCopyright',
      condition: (content: string) => !content.includes('å…·ä½“ä½œå“å'),
      action: 'flag_content'
    },
    {
      rule: 'checkDisclaimer',
      condition: (content: string) => content.includes('å…è´£') || content.includes('å£°æ˜'),
      action: 'add_disclaimer'
    }
  ],

  // è‡ªåŠ¨ä¼˜åŒ–
  autoOptimizations: [
    'addSEOTags',        // è‡ªåŠ¨æ·»åŠ SEOæ ‡ç­¾
    'formatMarkdown',    // æ ¼å¼åŒ–markdown
    'addEmojis',         // é€‚å½“æ·»åŠ emoji
    'checkReadability'   // æ£€æŸ¥å¯è¯»æ€§
  ]
};

export default {
  CURRENT_CONFIG,
  PROMPT_TEMPLATES,
  POST_PROCESSING_RULES
};